# Flow 模块

## 1. 模块定位

* **职责**：提供函数式编程支持和错误处理机制，包括状态管理、期望类型、函数式工具和错误处理，为引擎提供统一的流程控制和错误处理框架。
* **边界**：不提供复杂的业务逻辑，仅专注于流程控制和错误处理的基础构建块；不依赖外部库，仅使用C++标准库。
* **外部依赖**：C++标准库、Element模块。

## 2. 设计

### 2.1 核心设计原则

* **函数式优先**：采用函数式编程范式，支持链式调用和组合
* **错误安全**：通过强制检查的期望类型确保错误被正确处理
* **高性能**：所有组件设计优先考虑性能，避免不必要的运行时开销
* **可组合性**：设计支持组合的组件，便于构建复杂的流程

### 2.2 模块结构

* **Status**：表示操作状态，包含状态码和消息
* **Expect**：表示可能成功或失败的操作结果，类似于Rust的Result类型
* **StatusCode**：定义标准状态码
* **StatusDomain**：状态码域管理
* **StatusHelpers**：状态处理辅助工具
* **Functional**：函数式编程工具

## 3. API

### 3.1 核心类型

| 类型 | 描述 |
|------|------|
| `Status` | 操作状态，包含状态码和消息 |
| `Expect<T>` | 可能成功或失败的操作结果，T为成功类型 |
| `Expect<void>` | 无返回值的操作结果 |

### 3.2 状态处理

| 方法 | 描述 |
|------|------|
| `Status::Ok()` | 检查状态是否成功 |
| `Expect<T>::IsOk()` | 检查期望是否成功 |
| `Expect<T>::Ok()` | 检查期望是否成功（别名） |
| `Expect<T>::Value()` | 获取成功值（未检查时断言） |
| `Expect<T>::Error()` | 获取错误状态 |
| `Expect<T>::Ok(Args&&...)` | 创建成功的期望 |
| `Expect<T>::Err(Args&&...)` | 创建失败的期望 |

### 3.3 函数式工具

* 提供函数组合、部分应用、闭包工具等函数式编程支持
* 支持链式调用和管道式编程风格

### 3.4 状态码系统

* 统一的状态码定义，支持扩展
* 状态码域管理，支持不同模块定义自己的状态码
* 提供标准状态码，如成功、失败、无效参数等