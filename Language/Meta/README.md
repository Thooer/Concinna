# Meta 模块

## 1. 模块定位

* **职责**：提供元编程支持，包括类型ID、类型列表、类型集合、可调用特性、反射支持等，为引擎提供强大的编译时编程能力。
* **边界**：不提供运行时功能，仅专注于编译时元编程；不依赖外部库，仅使用C++标准库和Element模块。
* **外部依赖**：C++标准库、Element模块。

## 2. 设计

### 2.1 核心设计原则

* **编译时优先**：所有功能优先考虑编译时计算，减少运行时开销
* **类型安全**：通过强类型设计确保元编程的类型安全
* **可扩展性**：设计开放的元编程框架，支持后续扩展
* **易用性**：提供简洁易用的API，降低元编程的使用门槛

### 2.2 模块结构

* **TypeID**：类型唯一标识符生成和管理
* **TypeList**：类型列表操作，包括包含检查、索引查询、元素访问等
* **TypeSet**：类型集合，提供类型包含检查等功能
* **CallableTraits**：可调用对象的类型特性提取
* **MemberInfo**：成员信息描述，用于反射
* **TypeInfo**：类型信息获取
* **CPO**：自定义点对象支持
* **Reflection**：反射支持，包括反射结构体和枚举

## 3. API

### 3.1 核心类型

| 类型 | 描述 |
|------|------|
| `TypeID` | 类型唯一标识符 |
| `TypeTag<T>` | 类型标签，用于传递类型信息 |
| `TypeList<Ts...>` | 类型列表，用于编译时类型操作 |
| `TypeSet<Components...>` | 类型集合，用于编译时类型包含检查 |
| `CallableTraits<T>` | 可调用对象的类型特性 |
| `MemberInfo<T>` | 成员信息描述 |
| `TypeInfo<T>` | 类型信息获取 |
| `Describe<T>` | 反射类型描述 |
| `EnumMemberInfo<E>` | 枚举成员信息 |

### 3.2 类型操作

| 函数/概念 | 描述 |
|-----------|------|
| `GetTypeID<T>()` | 获取类型的唯一标识符 |
| `ContainsV<T, List>` | 检查类型是否在类型列表中 |
| `IndexOfV<T, List>` | 获取类型在类型列表中的索引 |
| `AtT<I, List>` | 获取类型列表中指定索引的类型 |
| `ConcatT<L1, L2>` | 连接两个类型列表 |
| `Reflectable` | 反射结构体概念 |
| `ReflectableEnum` | 反射枚举概念 |

### 3.3 反射支持

| 函数 | 描述 |
|------|------|
| `GetTypeName()` | 获取类型名称 |
| `GetMemberCount()` | 获取成员数量 |
| `GetMemberInfo<I>()` | 获取指定索引的成员信息 |
| `GetEnumTypeName<E>()` | 获取枚举类型名称 |
| `GetEnumMemberCount<E>()` | 获取枚举成员数量 |
| `GetEnumMembers<E>()` | 获取枚举成员列表 |
| `ForEachMember<T>(f)` | 遍历类型的所有成员 |
| `GetMemberRef<T, I>(v)` | 获取指定索引的成员引用 |

### 3.4 自定义点对象

* 支持tag_invoke协议，用于实现自定义点对象
* 提供hash_t、equals_t、visit_fields_t等标准自定义点

### 3.5 可调用特性

* 提取可调用对象的返回类型、参数类型和参数数量
* 支持函数指针、成员函数指针、lambda等各种可调用对象